@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix uco-core: <https://ontology.unifiedcyberontology.org/uco/core/> .
@prefix uco-identity: <https://ontology.unifiedcyberontology.org/uco/identity/> .
@prefix uco-observable: <https://ontology.unifiedcyberontology.org/uco/observable/> .
@prefix uco-action: <https://ontology.unifiedcyberontology.org/uco/action/> .
@prefix uco-tool: <https://ontology.unifiedcyberontology.org/uco/tool/> .
@prefix uco-types: <https://ontology.unifiedcyberontology.org/uco/types/> .
@prefix case-investigation: <https://ontology.caseontology.org/case/investigation/> .
@prefix cacontology: <https://cacontology.projectvic.org#> .
@prefix cacontology-forensics: <https://cacontology.projectvic.org/forensics#> .
@prefix cacontology-detection: <https://cacontology.projectvic.org/detection#> .
@prefix cacontology-platforms: <https://cacontology.projectvic.org/platforms#> .
@prefix cacontology-hotlines: <https://cacontology.projectvic.org/hotlines/2025/core#> .
@prefix gufo: <http://purl.org/nemo/gufo#> .

# =============================================================================
# ENHANCED ICAC INVESTIGATION LIFECYCLE EXAMPLE
# Demonstrating integration of forensics, detection, and platforms ontologies
# =============================================================================

# Investigation
cacontology:investigation-enhanced-001 rdf:type cacontology:ICACInvestigation ;
    rdfs:label "Enhanced Multi-Platform CSAM Investigation"@en ;
    rdfs:comment "Complete investigation lifecycle demonstrating forensics, detection, and platform integration."@en ;
    case-investigation:hasReport cacontology:initial-cybertip-001 ;
    cacontology:hasStep cacontology:step-001, cacontology:step-002, cacontology:step-003, cacontology:step-004, cacontology:step-005, cacontology:step-006, cacontology:step-007 .

# =============================================================================
# STEP 1: RECEIVE CYBERTIP WITH PLATFORM CONTEXT
# =============================================================================

cacontology:step-001 rdf:type cacontology:ReceiveCybertipAction ;
    rdfs:label "Receive Enhanced Cybertip"@en ;
    uco-core:startTime "2024-12-19T09:00:00Z"^^xsd:dateTime ;
    uco-core:endTime "2024-12-19T09:15:00Z"^^xsd:dateTime ;
    uco-core:object cacontology:initial-cybertip-001 ;
    cacontology:nextStep cacontology:step-002 .

cacontology:initial-cybertip-001 rdf:type cacontology-hotlines:ESPReport ;
    rdfs:label "Instagram CSAM Report"@en ;
    cacontology-hotlines:reportedBy cacontology:esp-meta-001 ;
    cacontology-hotlines:hasEvidence cacontology:evidence-image-001, cacontology:evidence-account-001 ;
    cacontology-platforms:operatedBy cacontology:platform-instagram-001 .

# Platform Context
cacontology:platform-instagram-001 rdf:type cacontology-platforms:SocialMediaPlatform ;
    rdfs:label "Instagram"@en ;
    cacontology-platforms:operatedBy cacontology:esp-meta-001 ;
    cacontology-platforms:platformType "social media" ;
    cacontology-platforms:primaryUserBase "teens and adults" ;
    cacontology-platforms:hasContentModerationCapability cacontology:moderation-capability-001 .

cacontology:esp-meta-001 rdf:type cacontology-platforms:ElectronicServiceProvider ;
    rdfs:label "Meta Platforms Inc."@en ;
    cacontology-platforms:headquarteredIn "United States" ;
    cacontology-platforms:operatesInJurisdiction "Global" .

cacontology:moderation-capability-001 rdf:type cacontology-platforms:ContentModerationCapability ;
    cacontology-platforms:moderationMethod "hybrid" ;
    cacontology-platforms:csaiDetectionEnabled true ;
    cacontology-platforms:hashMatchingEnabled true .

# =============================================================================
# STEP 2: AUTOMATED DETECTION AND CLASSIFICATION
# =============================================================================

cacontology:step-002 rdf:type cacontology-detection:AutomatedDetectionAction ;
    rdfs:label "Automated CSAM Detection"@en ;
    uco-core:startTime "2024-12-19T09:15:00Z"^^xsd:dateTime ;
    uco-core:endTime "2024-12-19T09:30:00Z"^^xsd:dateTime ;
    uco-action:usesTool cacontology:detection-tool-001 ;
    cacontology-detection:detectedContent cacontology:evidence-image-001 ;
    cacontology-detection:detectionThreshold 0.85 ;
    uco-core:result cacontology:detection-result-001 ;
    cacontology:nextStep cacontology:step-003 .

cacontology:detection-tool-001 rdf:type cacontology-detection:MachineLearningDetectionTool ;
    rdfs:label "NCMEC Hash Matcher & ML Classifier"@en ;
    cacontology-detection:modelVersion "v2.1.3" .

cacontology:detection-result-001 rdf:type cacontology-detection:DetectionResult ;
    cacontology-detection:confidenceScore 0.94 ;
    cacontology-detection:sarClassification cacontology-detection:sar-4 .

# Generated Hashes
cacontology:step-002a rdf:type cacontology-detection:ContentHashingAction ;
    rdfs:label "Generate Content Hashes"@en ;
    uco-core:startTime "2024-12-19T09:20:00Z"^^xsd:dateTime ;
    uco-core:object cacontology:evidence-image-001 ;
    cacontology-detection:generatedHash cacontology:hash-photodna-001, cacontology:hash-md5-001 .

cacontology:hash-photodna-001 rdf:type cacontology-detection:PhotoDNAHash ;
    cacontology-detection:photoDNAValue "A1B2C3D4E5F6789012345678901234567890ABCD" .

cacontology:hash-md5-001 rdf:type uco-types:Hash ;
    uco-types:hashMethod "MD5" ;
    uco-types:hashValue "d41d8cd98f00b204e9800998ecf8427e" .

# =============================================================================
# STEP 3: MANUAL CLASSIFICATION BY ANALYST
# =============================================================================

cacontology:step-003 rdf:type cacontology-detection:ManualClassificationAction ;
    rdfs:label "Analyst Classification Review"@en ;
    uco-core:startTime "2024-12-19T10:00:00Z"^^xsd:dateTime ;
    uco-core:endTime "2024-12-19T10:30:00Z"^^xsd:dateTime ;
    cacontology-detection:reviewedBy cacontology:analyst-001 ;
    uco-core:object cacontology:evidence-image-001 ;
    cacontology-detection:reviewDecision "confirmed" ;
    cacontology-detection:sarClassification cacontology-detection:sar-4 ;
    cacontology-detection:copineClassification cacontology-detection:copine-8 ;
    cacontology:nextStep cacontology:step-004 .

cacontology:analyst-001 rdf:type uco-identity:Person ;
    rdfs:label "Detective Sarah Johnson"@en .

# =============================================================================
# STEP 4: LEGAL PROCESS AND PLATFORM COOPERATION
# =============================================================================

cacontology:step-004 rdf:type cacontology:LegalProcessAction ;
    rdfs:label "Request Platform Data Preservation"@en ;
    uco-core:startTime "2024-12-19T11:00:00Z"^^xsd:dateTime ;
    cacontology:targetsService cacontology:platform-instagram-001 ;
    cacontology:legalInstrument cacontology:preservation-request-001 ;
    uco-core:result cacontology:preservation-action-001 ;
    cacontology:nextStep cacontology:step-005 .

cacontology:preservation-request-001 rdf:type uco-observable:ObservableObject ;
    rdfs:label "Emergency Data Preservation Request"@en .

cacontology:preservation-action-001 rdf:type cacontology-platforms:DataPreservationAction ;
    rdfs:label "Instagram Data Preservation"@en ;
    uco-core:performer cacontology:esp-meta-001 ;
    cacontology-platforms:preservationPeriod 90 ;
    uco-core:object cacontology:evidence-account-001 .

# =============================================================================
# STEP 5: FORENSIC DEVICE ACQUISITION
# =============================================================================

cacontology:step-005 rdf:type cacontology-forensics:ForensicAcquisitionAction ;
    rdfs:label "Mobile Device Forensic Acquisition"@en ;
    uco-core:startTime "2024-12-20T09:00:00Z"^^xsd:dateTime ;
    uco-core:endTime "2024-12-20T15:00:00Z"^^xsd:dateTime ;
    gufo:hasBeginPointInXSDDateTimeStamp "2024-12-20T09:00:00Z"^^xsd:dateTimeStamp ;
    uco-action:usesTool cacontology:forensic-tool-001 ;
    cacontology-forensics:acquisitionMethod "physical" ;
    cacontology-forensics:writeBlockingUsed true ;
    cacontology-forensics:evidenceSeized cacontology:seized-phone-001 ;
    cacontology-forensics:forensicCopy cacontology:forensic-image-001 ;
    cacontology:nextStep cacontology:step-006 .

cacontology:forensic-tool-001 rdf:type cacontology-forensics:MobileForensicTool ;
    rdf:type uco-tool:Tool ;
    rdfs:label "Cellebrite UFED Premium"@en ;
    uco-core:name "Cellebrite UFED Premium" .

cacontology:seized-phone-001 rdf:type uco-observable:MobileDevice ;
    rdf:type uco-core:UcoObject ;
    rdfs:label "Suspect iPhone 13"@en ;
    cacontology-forensics:evidenceLocation "suspect bedroom" ;
    cacontology-forensics:caseExhibitNumber "2024-001-A" .

cacontology:forensic-image-001 rdf:type cacontology-forensics:ForensicImage ;
    rdf:type uco-core:UcoObject ;
    rdfs:label "iPhone 13 Forensic Image"@en ;
    cacontology-forensics:verificationHash cacontology:verification-hash-001 ;
    cacontology-forensics:sourceHash cacontology:source-hash-001 ;
    gufo:hasBeginPointInXSDDateTimeStamp "2024-12-20T15:00:00Z"^^xsd:dateTimeStamp .

cacontology:verification-hash-001 rdf:type uco-types:Hash ;
    rdf:type uco-core:UcoObject ;
    uco-types:hashMethod "SHA256" ;
    uco-types:hashValue "abc123def456789012345678901234567890abcdef123456789012345678901234" .

cacontology:source-hash-001 rdf:type uco-types:Hash ;
    rdf:type uco-core:UcoObject ;
    uco-types:hashMethod "SHA256" ;
    uco-types:hashValue "abc123def456789012345678901234567890abcdef123456789012345678901234" .

# =============================================================================
# STEP 6: CHAIN OF CUSTODY DOCUMENTATION
# =============================================================================

cacontology:step-006 rdf:type cacontology-forensics:ChainOfCustodyAction ;
    rdfs:label "Evidence Transfer to Lab"@en ;
    uco-core:startTime "2024-12-20T16:00:00Z"^^xsd:dateTime ;
    gufo:hasBeginPointInXSDDateTimeStamp "2024-12-20T16:00:00Z"^^xsd:dateTimeStamp ;
    cacontology-forensics:custodyTransferredFrom cacontology:officer-001 ;
    cacontology-forensics:custodyTransferredTo cacontology:lab-analyst-001 ;
    cacontology-forensics:custodyReason "analysis" ;
    uco-core:object cacontology:forensic-image-001 ;
    cacontology:nextStep cacontology:step-007 .

cacontology:officer-001 rdf:type uco-identity:Person ;
    rdf:type uco-core:UcoObject ;
    rdfs:label "Officer Mike Rodriguez"@en .

cacontology:lab-analyst-001 rdf:type uco-identity:Person ;
    rdf:type uco-core:UcoObject ;
    rdfs:label "Forensic Analyst Lisa Chen"@en .

# =============================================================================
# STEP 7: RECOVERED EVIDENCE ANALYSIS
# =============================================================================

cacontology:step-007 rdf:type cacontology-forensics:MetadataExtractionAction ;
    rdfs:label "Extract and Analyze Recovered Files"@en ;
    uco-core:startTime "2024-12-21T09:00:00Z"^^xsd:dateTime ;
    gufo:hasBeginPointInXSDDateTimeStamp "2024-12-21T09:00:00Z"^^xsd:dateTimeStamp ;
    uco-action:usesTool cacontology:analysis-tool-001 ;
    uco-core:object cacontology:forensic-image-001 ;
    uco-core:result cacontology:recovered-files-001 .

cacontology:analysis-tool-001 rdf:type uco-tool:AnalyticTool ;
    rdf:type uco-tool:Tool ;
    rdfs:label "Autopsy Digital Forensics Platform"@en .

cacontology:recovered-files-001 rdf:type cacontology-forensics:RecoveredFile ;
    rdfs:label "Deleted Instagram Photos"@en ;
    cacontology-forensics:recoveryMethod "unallocated-space" ;
    uco-core:hasFacet cacontology:file-metadata-001 .

cacontology:file-metadata-001 rdf:type uco-observable:EXIFFacet ;
    uco-observable:exifData [
        uco-observable:dateTimeOriginal "2024-12-15T14:30:00Z"^^xsd:dateTime ;
        uco-observable:gpsLatitude "40.7589"^^xsd:decimal ;
        uco-observable:gpsLongitude "-73.9851"^^xsd:decimal
    ] .

# =============================================================================
# EVIDENCE ITEMS
# =============================================================================

cacontology:evidence-image-001 rdf:type cacontology-hotlines:ImageEvidence ;
    rdfs:label "Reported CSAM Image"@en ;
    uco-core:hasFacet cacontology:image-facet-001 ;
    cacontology-detection:sarClassification cacontology-detection:sar-4 ;
    cacontology-detection:ageEstimate "approximately 12-14 years" .

cacontology:image-facet-001 rdf:type uco-observable:ContentDataFacet ;
    uco-observable:mimeType "image/jpeg" ;
    uco-observable:sizeInBytes 2048576 .

cacontology:evidence-account-001 rdf:type uco-observable:DigitalAccount ;
    rdfs:label "Instagram Account @user123"@en ;
    uco-core:hasFacet cacontology:account-facet-001 .

cacontology:account-facet-001 rdf:type uco-observable:AccountFacet ;
    uco-observable:accountIdentifier "@user123" ;
    uco-observable:accountType "social_media" ;
    uco-observable:isActive true . 